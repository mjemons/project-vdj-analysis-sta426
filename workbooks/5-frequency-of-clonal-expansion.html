<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="5 Frequency of clonal expansion | Autoproliferation Analysis of B Cells in the context of Multiple Sclerosis" />
<meta property="og:type" content="book" />





<meta name="author" content="Richard Affolter, Martin Emons, Philip Hartout" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="5 Frequency of clonal expansion | Autoproliferation Analysis of B Cells in the context of Multiple Sclerosis">

<title>5 Frequency of clonal expansion | Autoproliferation Analysis of B Cells in the context of Multiple Sclerosis</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="1-introduction.html#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li class="has-sub"><a href="2-exploratory-data-analysis.html#exploratory-data-analysis"><span class="toc-section-number">2</span> Exploratory Data Analysis</a><ul>
<li><a href="2-exploratory-data-analysis.html#sample-level-descriptive-statistics"><span class="toc-section-number">2.1</span> Sample-level Descriptive Statistics</a></li>
<li><a href="2-exploratory-data-analysis.html#cell-level-descriptive-statistics"><span class="toc-section-number">2.2</span> Cell-level Descriptive Statistics</a></li>
</ul></li>
<li class="has-sub"><a href="3-preprocessing-of-raw-data.html#preprocessing-of-raw-data"><span class="toc-section-number">3</span> Preprocessing of raw Data</a><ul>
<li><a href="3-preprocessing-of-raw-data.html#demultiplexing"><span class="toc-section-number">3.1</span> Demultiplexing</a></li>
</ul></li>
<li class="has-sub"><a href="4-bracer.html#bracer"><span class="toc-section-number">4</span> <code>BraCeR</code></a><ul>
<li><a href="4-bracer.html#assemble"><span class="toc-section-number">4.1</span> Assemble</a></li>
<li><a href="4-bracer.html#summarise"><span class="toc-section-number">4.2</span> Summarise</a></li>
<li><a href="4-bracer.html#packaging-for-downstream-analysis"><span class="toc-section-number">4.3</span> Packaging for downstream analysis</a></li>
</ul></li>
<li><a href="5-frequency-of-clonal-expansion.html#frequency-of-clonal-expansion"><span class="toc-section-number">5</span> Frequency of clonal expansion</a></li>
<li><a href="6-isotype-analysis.html#isotype-analysis"><span class="toc-section-number">6</span> Isotype Analysis</a></li>
<li><a href="7-discussion.html#discussion"><span class="toc-section-number">7</span> Discussion</a></li>
<li><a href="8-summary.html#summary"><span class="toc-section-number">8</span> Summary</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="frequency-of-clonal-expansion" class="section level1">
<h1><span class="header-section-number">5</span> Frequency of clonal expansion</h1>
<p>The files <code>clonotype_sizes.txt</code>from <code>summarise</code> contain a table with the columns clonotype_sizes and clonotype_count. They can be read into R, as shown below,
and used for downstream analysis.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="5-frequency-of-clonal-expansion.html#cb19-1"></a><span class="kw">library</span>(dotenv)</span>
<span id="cb19-2"><a href="5-frequency-of-clonal-expansion.html#cb19-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb19-3"><a href="5-frequency-of-clonal-expansion.html#cb19-3"></a><span class="kw">library</span>(SummarizedExperiment)</span>
<span id="cb19-4"><a href="5-frequency-of-clonal-expansion.html#cb19-4"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb19-5"><a href="5-frequency-of-clonal-expansion.html#cb19-5"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb19-6"><a href="5-frequency-of-clonal-expansion.html#cb19-6"></a></span>
<span id="cb19-7"><a href="5-frequency-of-clonal-expansion.html#cb19-7"></a><span class="kw">load</span>(<span class="st">&quot;annotation.RData&quot;</span>)</span>
<span id="cb19-8"><a href="5-frequency-of-clonal-expansion.html#cb19-8"></a></span>
<span id="cb19-9"><a href="5-frequency-of-clonal-expansion.html#cb19-9"></a><span class="co"># cut the lib id string and keep only the first part</span></span>
<span id="cb19-10"><a href="5-frequency-of-clonal-expansion.html#cb19-10"></a><span class="kw">separate</span>(<span class="dt">data =</span> simplified_annotation,</span>
<span id="cb19-11"><a href="5-frequency-of-clonal-expansion.html#cb19-11"></a>         <span class="dt">col =</span> lib_id, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;lib_id&quot;</span>, <span class="st">&quot;rest&quot;</span>), <span class="dt">extra =</span> <span class="st">&quot;merge&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb19-12"><a href="5-frequency-of-clonal-expansion.html#cb19-12"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>rest) -&gt;<span class="st"> </span>simplified_annotation</span>
<span id="cb19-13"><a href="5-frequency-of-clonal-expansion.html#cb19-13"></a><span class="kw">rownames</span>(simplified_annotation) =<span class="st"> </span>simplified_annotation<span class="op">$</span>lib_id</span>
<span id="cb19-14"><a href="5-frequency-of-clonal-expansion.html#cb19-14"></a></span>
<span id="cb19-15"><a href="5-frequency-of-clonal-expansion.html#cb19-15"></a><span class="kw">load_dot_env</span>(<span class="dt">file =</span> <span class="st">&quot;.env&quot;</span>)</span>
<span id="cb19-16"><a href="5-frequency-of-clonal-expansion.html#cb19-16"></a></span>
<span id="cb19-17"><a href="5-frequency-of-clonal-expansion.html#cb19-17"></a></span>
<span id="cb19-18"><a href="5-frequency-of-clonal-expansion.html#cb19-18"></a><span class="co"># Load data, note that summarise_data should be in data/</span></span>
<span id="cb19-19"><a href="5-frequency-of-clonal-expansion.html#cb19-19"></a>file_path =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">Sys.getenv</span>(<span class="kw">c</span>(<span class="st">&quot;HOME_DIR&quot;</span>)),<span class="st">&quot;data/summarise_data&quot;</span>)</span>
<span id="cb19-20"><a href="5-frequency-of-clonal-expansion.html#cb19-20"></a></span>
<span id="cb19-21"><a href="5-frequency-of-clonal-expansion.html#cb19-21"></a><span class="co"># determine the highest clonotype size in the data</span></span>
<span id="cb19-22"><a href="5-frequency-of-clonal-expansion.html#cb19-22"></a>max_clonotype_size =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb19-23"><a href="5-frequency-of-clonal-expansion.html#cb19-23"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">list.files</span>(<span class="dt">path =</span> file_path)){</span>
<span id="cb19-24"><a href="5-frequency-of-clonal-expansion.html#cb19-24"></a></span>
<span id="cb19-25"><a href="5-frequency-of-clonal-expansion.html#cb19-25"></a>  tmp_path =<span class="st"> </span><span class="kw">paste0</span>(file_path,<span class="st">&quot;/&quot;</span>,i,<span class="st">&quot;/clonotype_sizes.txt&quot;</span>)</span>
<span id="cb19-26"><a href="5-frequency-of-clonal-expansion.html#cb19-26"></a>  tmp =<span class="st"> </span><span class="kw">read.table</span>(tmp_path, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb19-27"><a href="5-frequency-of-clonal-expansion.html#cb19-27"></a></span>
<span id="cb19-28"><a href="5-frequency-of-clonal-expansion.html#cb19-28"></a></span>
<span id="cb19-29"><a href="5-frequency-of-clonal-expansion.html#cb19-29"></a>  <span class="cf">if</span> (<span class="kw">max</span>(tmp<span class="op">$</span>clonotype_size) <span class="op">&gt;</span><span class="st"> </span>max_clonotype_size){</span>
<span id="cb19-30"><a href="5-frequency-of-clonal-expansion.html#cb19-30"></a>    max_clonotype_size =<span class="st"> </span><span class="kw">max</span>(tmp<span class="op">$</span>clonotype_size)</span>
<span id="cb19-31"><a href="5-frequency-of-clonal-expansion.html#cb19-31"></a>  }</span>
<span id="cb19-32"><a href="5-frequency-of-clonal-expansion.html#cb19-32"></a>}</span>
<span id="cb19-33"><a href="5-frequency-of-clonal-expansion.html#cb19-33"></a></span>
<span id="cb19-34"><a href="5-frequency-of-clonal-expansion.html#cb19-34"></a><span class="co"># prepare empty data frame (df for frequency and df_complete for clonotype counts)</span></span>
<span id="cb19-35"><a href="5-frequency-of-clonal-expansion.html#cb19-35"></a>df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lib_id =</span> <span class="kw">character</span>(), <span class="dt">expansion_frequency =</span> <span class="kw">double</span>())</span>
<span id="cb19-36"><a href="5-frequency-of-clonal-expansion.html#cb19-36"></a>df_complete =<span class="st"> </span><span class="kw">data.frame</span>()</span>
<span id="cb19-37"><a href="5-frequency-of-clonal-expansion.html#cb19-37"></a>lib_ids =<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb19-38"><a href="5-frequency-of-clonal-expansion.html#cb19-38"></a></span>
<span id="cb19-39"><a href="5-frequency-of-clonal-expansion.html#cb19-39"></a><span class="co"># loop over all files and fill the dataframes</span></span>
<span id="cb19-40"><a href="5-frequency-of-clonal-expansion.html#cb19-40"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">list.files</span>(<span class="dt">path =</span> file_path)){</span>
<span id="cb19-41"><a href="5-frequency-of-clonal-expansion.html#cb19-41"></a></span>
<span id="cb19-42"><a href="5-frequency-of-clonal-expansion.html#cb19-42"></a>  tmp_path =<span class="st"> </span><span class="kw">paste0</span>(file_path,<span class="st">&quot;/&quot;</span>,i,<span class="st">&quot;/clonotype_sizes.txt&quot;</span>)</span>
<span id="cb19-43"><a href="5-frequency-of-clonal-expansion.html#cb19-43"></a>  tmp =<span class="st"> </span><span class="kw">read.table</span>(tmp_path, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb19-44"><a href="5-frequency-of-clonal-expansion.html#cb19-44"></a></span>
<span id="cb19-45"><a href="5-frequency-of-clonal-expansion.html#cb19-45"></a>  <span class="co"># calculate frequency of clonal expansion (clonotype size &gt;= 2)</span></span>
<span id="cb19-46"><a href="5-frequency-of-clonal-expansion.html#cb19-46"></a>  freq=tmp<span class="op">$</span>clonotype_size<span class="op">*</span>tmp<span class="op">$</span>clonotype_count</span>
<span id="cb19-47"><a href="5-frequency-of-clonal-expansion.html#cb19-47"></a>  sum_freq=<span class="kw">sum</span>(freq)</span>
<span id="cb19-48"><a href="5-frequency-of-clonal-expansion.html#cb19-48"></a>  freq=(sum_freq <span class="op">-</span><span class="st"> </span>freq[<span class="dv">1</span>])<span class="op">/</span>sum_freq</span>
<span id="cb19-49"><a href="5-frequency-of-clonal-expansion.html#cb19-49"></a></span>
<span id="cb19-50"><a href="5-frequency-of-clonal-expansion.html#cb19-50"></a>  <span class="co">#split the string at &quot;-&quot; or &quot;_&quot; to remove &quot;-preprocessed&quot; and &quot;POOL*&quot; and</span></span>
<span id="cb19-51"><a href="5-frequency-of-clonal-expansion.html#cb19-51"></a>  <span class="co"># remove the &quot;B&quot;</span></span>
<span id="cb19-52"><a href="5-frequency-of-clonal-expansion.html#cb19-52"></a>  lib_name =<span class="st"> </span><span class="kw">strsplit</span>(i, <span class="st">&quot;[-_]+&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span><span class="st"> </span>.[<span class="dv">1</span>]</span>
<span id="cb19-53"><a href="5-frequency-of-clonal-expansion.html#cb19-53"></a>  lib_name =<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;&quot;</span>,lib_name)</span>
<span id="cb19-54"><a href="5-frequency-of-clonal-expansion.html#cb19-54"></a></span>
<span id="cb19-55"><a href="5-frequency-of-clonal-expansion.html#cb19-55"></a>  expand_tmp =<span class="st"> </span><span class="kw">list</span>(<span class="dt">lib_id =</span> lib_name, <span class="dt">expansion_frequency =</span> freq)</span>
<span id="cb19-56"><a href="5-frequency-of-clonal-expansion.html#cb19-56"></a>  df =<span class="st"> </span><span class="kw">rbind</span>(df,expand_tmp)</span>
<span id="cb19-57"><a href="5-frequency-of-clonal-expansion.html#cb19-57"></a></span>
<span id="cb19-58"><a href="5-frequency-of-clonal-expansion.html#cb19-58"></a>  lib_ids =<span class="st"> </span><span class="kw">c</span>(lib_ids,lib_name)</span>
<span id="cb19-59"><a href="5-frequency-of-clonal-expansion.html#cb19-59"></a></span>
<span id="cb19-60"><a href="5-frequency-of-clonal-expansion.html#cb19-60"></a>  <span class="co"># fill vector with zeros up to max clonotype size to have equal lengths</span></span>
<span id="cb19-61"><a href="5-frequency-of-clonal-expansion.html#cb19-61"></a>  adjusted_clonotype_count =<span class="st"> </span><span class="kw">c</span>(tmp<span class="op">$</span>clonotype_count,</span>
<span id="cb19-62"><a href="5-frequency-of-clonal-expansion.html#cb19-62"></a>                              <span class="kw">rep</span>(<span class="dv">0</span>,(max_clonotype_size <span class="op">-</span></span>
<span id="cb19-63"><a href="5-frequency-of-clonal-expansion.html#cb19-63"></a><span class="st">                              </span><span class="kw">max</span>(tmp<span class="op">$</span>clonotype_size))))</span>
<span id="cb19-64"><a href="5-frequency-of-clonal-expansion.html#cb19-64"></a></span>
<span id="cb19-65"><a href="5-frequency-of-clonal-expansion.html#cb19-65"></a>  df_complete =<span class="st"> </span><span class="kw">rbind</span>(df_complete, adjusted_clonotype_count)</span>
<span id="cb19-66"><a href="5-frequency-of-clonal-expansion.html#cb19-66"></a>  }</span>
<span id="cb19-67"><a href="5-frequency-of-clonal-expansion.html#cb19-67"></a></span>
<span id="cb19-68"><a href="5-frequency-of-clonal-expansion.html#cb19-68"></a><span class="kw">colnames</span>(df_complete) =<span class="st"> </span><span class="dv">1</span><span class="op">:</span>max_clonotype_size</span>
<span id="cb19-69"><a href="5-frequency-of-clonal-expansion.html#cb19-69"></a><span class="kw">rownames</span>(df_complete) =<span class="st"> </span>lib_ids</span></code></pre></div>
<pre><code>##   clonotype_size clonotype_count
## 1              1            3409
## 2              2             272
## 3              3              78
## 4              4              32
## 5              5              19
## 6              6               9</code></pre>
<p>Shown above is a part of such a table. A clonotype of size 1 means, that only
one cell is in the cluster and is therefore unique.
The tables of each sample (each folder in the output directory) are combined
into a dataframe called <code>df_complete</code>. The column index of the dataframe
indicates the clonotype size and the rownames specify the lib_id (sample name).
Since the table of each lib_id directory has the same number of rows as the
highest clonotype_size of that lib_id, the missing entries of <code>df_complete</code> are
filled with zeros.
A section of <code>df_complete</code> is shown below.
The highest clonotype_size in our data is 147</p>
<pre><code>##          1   2   3  4  5  6  7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
## IJ009 3771  62   8  0  1  0  0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
## IJ010 2091 325 107 66 25 14 13 7 3  0  0  1  2  1  0  2  0  0  0  0  0  0  0  0
## IJ013 3261  96   9  2  1  0  0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</code></pre>
<p>We can also calculate the frequency of clonal expansion, using the definiton of
clonal expansion of <span class="citation">(Ramesh et al. 2020)</span>
“as a highly similar B cell cluster containing two or more B cells”.
The clonal expansion frequency of a sample is therefore</p>
<p><span class="math display">\[
\frac{\text{number of cells with clonotype_size &gt;1}}{\text{total number of cell in the sample}}
\]</span></p>
<p>The clonal expansion frequencies of each sample are combined in the
dataframe <code>df</code>.</p>
<pre><code>##   lib_id expansion_frequency
## 1  IJ009          0.03899083
## 2  IJ010          0.45376176
## 3  IJ013          0.06641855
## 4  IJ014          0.48298349
## 5  IJ015          0.18520594
## 6  IJ016          0.45045455</code></pre>
<p>For better visualization we also make a data frame where we pool all clonotype
counts of size <span class="math inline">\(&gt;4\)</span> into one category, a procedure also adopted in the literature
<span class="citation">(Ramesh et al. 2020)</span>. We also make a separate data frame where we normalize by the number of
cells per sample to get a proportion.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="5-frequency-of-clonal-expansion.html#cb23-1"></a><span class="co"># condense all clonotypes &gt; 4 into one category and make a new data frame</span></span>
<span id="cb23-2"><a href="5-frequency-of-clonal-expansion.html#cb23-2"></a>condensed_sum =<span class="st"> </span><span class="kw">rowSums</span>(df_complete[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)])</span>
<span id="cb23-3"><a href="5-frequency-of-clonal-expansion.html#cb23-3"></a>df_summarized =<span class="st"> </span><span class="kw">cbind</span>(df_complete[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)],condensed_sum)</span>
<span id="cb23-4"><a href="5-frequency-of-clonal-expansion.html#cb23-4"></a><span class="kw">colnames</span>(df_summarized) =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="st">&quot;&gt; 4&quot;</span>)</span>
<span id="cb23-5"><a href="5-frequency-of-clonal-expansion.html#cb23-5"></a></span>
<span id="cb23-6"><a href="5-frequency-of-clonal-expansion.html#cb23-6"></a><span class="co"># normalize by rowsum</span></span>
<span id="cb23-7"><a href="5-frequency-of-clonal-expansion.html#cb23-7"></a>df_summarized_normalized =<span class="st"> </span>df_summarized<span class="op">/</span><span class="kw">rowSums</span>(df_summarized)</span>
<span id="cb23-8"><a href="5-frequency-of-clonal-expansion.html#cb23-8"></a><span class="kw">head</span>(df_summarized)</span></code></pre></div>
<pre><code>##          1   2   3  4 &gt; 4
## IJ009 3771  62   8  0   1
## IJ010 2091 325 107 66  69
## IJ013 3261  96   9  2   1
## IJ014 2537 428 155 70 101
## IJ015 2908  78  33 14  46
## IJ016 2418 291 122 63  93</code></pre>
<p>After this, we add the annotation data to the dataframes we are ready for plotting.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="5-frequency-of-clonal-expansion.html#cb25-1"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb25-2"><a href="5-frequency-of-clonal-expansion.html#cb25-2"></a><span class="kw">library</span>(gtable)</span>
<span id="cb25-3"><a href="5-frequency-of-clonal-expansion.html#cb25-3"></a></span>
<span id="cb25-4"><a href="5-frequency-of-clonal-expansion.html#cb25-4"></a><span class="co"># merge the annotation with the data frames</span></span>
<span id="cb25-5"><a href="5-frequency-of-clonal-expansion.html#cb25-5"></a>df =<span class="st"> </span><span class="kw">merge</span>(df, simplified_annotation, <span class="dt">by.x =</span> <span class="st">&quot;lib_id&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;lib_id&quot;</span>)</span>
<span id="cb25-6"><a href="5-frequency-of-clonal-expansion.html#cb25-6"></a><span class="kw">rownames</span>(simplified_annotation) =<span class="st"> </span>simplified_annotation<span class="op">$</span>lib_id</span>
<span id="cb25-7"><a href="5-frequency-of-clonal-expansion.html#cb25-7"></a></span>
<span id="cb25-8"><a href="5-frequency-of-clonal-expansion.html#cb25-8"></a>df_summarized =<span class="st"> </span><span class="kw">merge</span>(df_summarized, simplified_annotation, <span class="dt">by =</span> <span class="st">&quot;row.names&quot;</span>)</span>
<span id="cb25-9"><a href="5-frequency-of-clonal-expansion.html#cb25-9"></a></span>
<span id="cb25-10"><a href="5-frequency-of-clonal-expansion.html#cb25-10"></a><span class="kw">rownames</span>(df_summarized) =<span class="st"> </span>df_summarized<span class="op">$</span>Row.names</span>
<span id="cb25-11"><a href="5-frequency-of-clonal-expansion.html#cb25-11"></a>df_summarized =<span class="st"> </span><span class="kw">subset</span>(df_summarized, <span class="dt">select =</span> <span class="op">-</span>Row.names)</span>
<span id="cb25-12"><a href="5-frequency-of-clonal-expansion.html#cb25-12"></a></span>
<span id="cb25-13"><a href="5-frequency-of-clonal-expansion.html#cb25-13"></a>df_summarized_normalized =<span class="st"> </span><span class="kw">merge</span>(df_summarized_normalized, simplified_annotation, <span class="dt">by =</span> <span class="st">&quot;row.names&quot;</span>)</span>
<span id="cb25-14"><a href="5-frequency-of-clonal-expansion.html#cb25-14"></a></span>
<span id="cb25-15"><a href="5-frequency-of-clonal-expansion.html#cb25-15"></a><span class="kw">rownames</span>(df_summarized_normalized) =<span class="st"> </span>df_summarized_normalized<span class="op">$</span>Row.names</span>
<span id="cb25-16"><a href="5-frequency-of-clonal-expansion.html#cb25-16"></a>df_summarized_normalized =<span class="st"> </span><span class="kw">subset</span>(df_summarized_normalized, <span class="dt">select =</span> <span class="op">-</span>Row.names)</span></code></pre></div>
<p>If we try to analyse the clonotype vectors directly (so a row in <code>df_complete</code>
above) and look how similar in terms of a euclidean distance they are, we can
perform a hierarchical clustering and get the dendrogram below.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="5-frequency-of-clonal-expansion.html#cb26-1"></a><span class="co">#plotting the clustering of id&#39;s according to their clonotype</span></span>
<span id="cb26-2"><a href="5-frequency-of-clonal-expansion.html#cb26-2"></a><span class="kw">library</span>(dendextend)</span>
<span id="cb26-3"><a href="5-frequency-of-clonal-expansion.html#cb26-3"></a><span class="kw">library</span>(ggfortify)</span>
<span id="cb26-4"><a href="5-frequency-of-clonal-expansion.html#cb26-4"></a></span>
<span id="cb26-5"><a href="5-frequency-of-clonal-expansion.html#cb26-5"></a>df_cluster =<span class="st"> </span>df_summarized[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb26-6"><a href="5-frequency-of-clonal-expansion.html#cb26-6"></a></span>
<span id="cb26-7"><a href="5-frequency-of-clonal-expansion.html#cb26-7"></a>col =<span class="st"> </span>df_summarized<span class="op">$</span>Sample.Type</span>
<span id="cb26-8"><a href="5-frequency-of-clonal-expansion.html#cb26-8"></a>col =<span class="st"> </span><span class="kw">ifelse</span>(col<span class="op">==</span><span class="st">&quot;AP&quot;</span>,<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>)</span>
<span id="cb26-9"><a href="5-frequency-of-clonal-expansion.html#cb26-9"></a></span>
<span id="cb26-10"><a href="5-frequency-of-clonal-expansion.html#cb26-10"></a>dist_mat =<span class="st"> </span><span class="kw">dist</span>(df_cluster, <span class="dt">method =</span> <span class="st">&#39;manhattan&#39;</span>)</span>
<span id="cb26-11"><a href="5-frequency-of-clonal-expansion.html#cb26-11"></a>hclust_avg =<span class="st"> </span><span class="kw">hclust</span>(dist_mat, <span class="dt">method =</span> <span class="st">&#39;average&#39;</span>)</span>
<span id="cb26-12"><a href="5-frequency-of-clonal-expansion.html#cb26-12"></a>avg_dend_obj =<span class="st"> </span><span class="kw">as.dendrogram</span>(hclust_avg)</span>
<span id="cb26-13"><a href="5-frequency-of-clonal-expansion.html#cb26-13"></a></span>
<span id="cb26-14"><a href="5-frequency-of-clonal-expansion.html#cb26-14"></a>colors_to_use &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(col))</span>
<span id="cb26-15"><a href="5-frequency-of-clonal-expansion.html#cb26-15"></a>colors_to_use &lt;-<span class="st"> </span>colors_to_use[<span class="kw">order.dendrogram</span>(avg_dend_obj)]</span>
<span id="cb26-16"><a href="5-frequency-of-clonal-expansion.html#cb26-16"></a></span>
<span id="cb26-17"><a href="5-frequency-of-clonal-expansion.html#cb26-17"></a><span class="kw">labels_colors</span>(avg_dend_obj) &lt;-<span class="st"> </span>colors_to_use</span>
<span id="cb26-18"><a href="5-frequency-of-clonal-expansion.html#cb26-18"></a></span>
<span id="cb26-19"><a href="5-frequency-of-clonal-expansion.html#cb26-19"></a><span class="kw">plot</span>(avg_dend_obj, <span class="dt">main =</span> <span class="st">&quot;Dendrogram of Samples coloured by AP vs nonAP&quot;</span>)</span>
<span id="cb26-20"><a href="5-frequency-of-clonal-expansion.html#cb26-20"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;AP&quot;</span>, <span class="st">&quot;nonAP&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb26-21"><a href="5-frequency-of-clonal-expansion.html#cb26-21"></a>       <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/plot%20dendogramm-1.png" width="672" /></p>
<p>After this, we also performed a PCA on the <code>clonotype_size</code> vectors.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="5-frequency-of-clonal-expansion.html#cb27-1"></a><span class="kw">library</span>(factoextra)</span>
<span id="cb27-2"><a href="5-frequency-of-clonal-expansion.html#cb27-2"></a><span class="co"># plot the PCA of the datapoints</span></span>
<span id="cb27-3"><a href="5-frequency-of-clonal-expansion.html#cb27-3"></a>pca =<span class="st"> </span><span class="kw">prcomp</span>(df_cluster, <span class="dt">center =</span> <span class="ot">TRUE</span>, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</span>
<span id="cb27-4"><a href="5-frequency-of-clonal-expansion.html#cb27-4"></a><span class="kw">fviz_eig</span>(pca, <span class="dt">main =</span> <span class="st">&quot;Principle Component Analysis, variance explained&quot;</span>,</span>
<span id="cb27-5"><a href="5-frequency-of-clonal-expansion.html#cb27-5"></a>         <span class="dt">xlab =</span> <span class="st">&quot;PCs&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/plot%20the%20contributions%20of%20the%20PCA-1.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="5-frequency-of-clonal-expansion.html#cb28-1"></a><span class="kw">library</span>(ggrepel)</span>
<span id="cb28-2"><a href="5-frequency-of-clonal-expansion.html#cb28-2"></a>labels =<span class="st"> </span>df<span class="op">$</span>lib_id</span>
<span id="cb28-3"><a href="5-frequency-of-clonal-expansion.html#cb28-3"></a>outlier_labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;IJ020&quot;</span>,<span class="st">&quot;IJ028&quot;</span>, <span class="st">&quot;IJ067&quot;</span>)</span>
<span id="cb28-4"><a href="5-frequency-of-clonal-expansion.html#cb28-4"></a>labels[df<span class="op">$</span>lib_id <span class="op">%in%</span><span class="st"> </span>outlier_labels <span class="op">%&gt;%</span><span class="st"> </span><span class="op">!</span>.] =<span class="st"> &quot;&quot;</span></span>
<span id="cb28-5"><a href="5-frequency-of-clonal-expansion.html#cb28-5"></a><span class="kw">autoplot</span>(pca, <span class="dt">scale =</span> <span class="dv">0</span>, <span class="dt">colour =</span> col, <span class="dt">data =</span>simplified_annotation) <span class="op">+</span></span>
<span id="cb28-6"><a href="5-frequency-of-clonal-expansion.html#cb28-6"></a><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">vjust=</span><span class="fl">1.5</span>, <span class="dt">label=</span>labels, <span class="dt">min.segment.length =</span> <span class="ot">Inf</span>) <span class="op">+</span></span>
<span id="cb28-7"><a href="5-frequency-of-clonal-expansion.html#cb28-7"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="st">&quot;Sample.Type&quot;</span>,</span>
<span id="cb28-8"><a href="5-frequency-of-clonal-expansion.html#cb28-8"></a>                           <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb28-9"><a href="5-frequency-of-clonal-expansion.html#cb28-9"></a>                           <span class="dt">drop =</span> <span class="ot">FALSE</span>,</span>
<span id="cb28-10"><a href="5-frequency-of-clonal-expansion.html#cb28-10"></a>                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;AP&quot;</span>, <span class="st">&quot;nonAP&quot;</span>)) <span class="op">+</span></span>
<span id="cb28-11"><a href="5-frequency-of-clonal-expansion.html#cb28-11"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;PCA plot AP (black) vs nonAP (red)&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/plot%20the%20PCA-1.png" width="672" /></p>
<p>We find that AP and nonAP samples actually cluster together already in terms of
the clonotype sizes. When looking at the PCA, we see that we can explain most of
the variability in our data with two principle components. When plotting the
points, we note that one point (IJ028) prevents our data to be linearly
separable. In the hierarchical clustering we see as well, that IJ028 clusters
with nonAP cells as well as the sample IJ020, which is the second closest point
to the putative separation line. We also see that sample IJ067, which has the
lowest cell count according to the exploratory data analysis, differs
significantly in PC2 and has the highest distance from the other samples, a
finding also supported in the dendrogram.</p>
<p>Plotted below are the absolute counts of clonal expansion grouped by sample type
and the proportion of clonal expansion grouped by sample type and diagnosis.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="5-frequency-of-clonal-expansion.html#cb29-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb29-2"><a href="5-frequency-of-clonal-expansion.html#cb29-2"></a>melted =<span class="st"> </span><span class="kw">melt</span>(df_summarized, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;lib_id&quot;</span>, <span class="st">&quot;Sample.Type&quot;</span>, <span class="st">&quot;Diagnosis&quot;</span>, </span>
<span id="cb29-3"><a href="5-frequency-of-clonal-expansion.html#cb29-3"></a>                                         <span class="st">&quot;HLADR15&quot;</span>))</span>
<span id="cb29-4"><a href="5-frequency-of-clonal-expansion.html#cb29-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> melted, <span class="kw">aes</span>(<span class="dt">fill=</span>variable, <span class="dt">x=</span>lib_id, <span class="dt">y=</span>value)) <span class="op">+</span></span>
<span id="cb29-5"><a href="5-frequency-of-clonal-expansion.html#cb29-5"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span></span>
<span id="cb29-6"><a href="5-frequency-of-clonal-expansion.html#cb29-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></span>
<span id="cb29-7"><a href="5-frequency-of-clonal-expansion.html#cb29-7"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span>Sample.Type, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span></span>
<span id="cb29-8"><a href="5-frequency-of-clonal-expansion.html#cb29-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Clonal expansion&quot;</span>) <span class="op">+</span></span>
<span id="cb29-9"><a href="5-frequency-of-clonal-expansion.html#cb29-9"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Sample Id&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Clonotype Count&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/plot%20the%20absolute%20clonal%20expansion-1.png" width="1344" /></p>
<p>Looking at the plots we see that one point in the AP samples is again a bit
anomalous, with less expansion than the others. It is also IJ028 that we
saw clusters with the nonAP samples (see above).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="5-frequency-of-clonal-expansion.html#cb30-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb30-2"><a href="5-frequency-of-clonal-expansion.html#cb30-2"></a>melted =<span class="st"> </span><span class="kw">melt</span>(df_summarized_normalized, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;lib_id&quot;</span>, <span class="st">&quot;Sample.Type&quot;</span>,</span>
<span id="cb30-3"><a href="5-frequency-of-clonal-expansion.html#cb30-3"></a>                                                    <span class="st">&quot;Diagnosis&quot;</span>, <span class="st">&quot;HLADR15&quot;</span>))</span>
<span id="cb30-4"><a href="5-frequency-of-clonal-expansion.html#cb30-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> melted, <span class="kw">aes</span>(<span class="dt">fill=</span>variable, <span class="dt">x=</span>lib_id, <span class="dt">y=</span>value)) <span class="op">+</span></span>
<span id="cb30-5"><a href="5-frequency-of-clonal-expansion.html#cb30-5"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span></span>
<span id="cb30-6"><a href="5-frequency-of-clonal-expansion.html#cb30-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></span>
<span id="cb30-7"><a href="5-frequency-of-clonal-expansion.html#cb30-7"></a><span class="st">  </span><span class="kw">facet_wrap</span>(Sample.Type<span class="op">~</span>Diagnosis, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span></span>
<span id="cb30-8"><a href="5-frequency-of-clonal-expansion.html#cb30-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Clonal expansion </span><span class="ch">\n</span><span class="st">clonotype size&quot;</span>) <span class="op">+</span></span>
<span id="cb30-9"><a href="5-frequency-of-clonal-expansion.html#cb30-9"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Sample Id&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion of Clonotype Count&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/plot%20the%20relative%20clonal%20expansion-1.png" width="1344" /></p>
<p>If we look at the proportion of clonotype counts and compare the sample types
we can see an increase in all clonotype size groups of type <code>AP</code>vs type <code>nonAP</code>.
But we do not see a pattern with respect to <code>diagnosis</code>.</p>
<p>Next we look at the frequencies of clonal expanion.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="5-frequency-of-clonal-expansion.html#cb31-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb31-2"><a href="5-frequency-of-clonal-expansion.html#cb31-2"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> Sample.Type, <span class="dt">y =</span> expansion_frequency, <span class="dt">color =</span> Diagnosis)) <span class="op">+</span></span>
<span id="cb31-3"><a href="5-frequency-of-clonal-expansion.html#cb31-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb31-4"><a href="5-frequency-of-clonal-expansion.html#cb31-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Sample Type&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;clonal expansion frequency&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb31-5"><a href="5-frequency-of-clonal-expansion.html#cb31-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb31-6"><a href="5-frequency-of-clonal-expansion.html#cb31-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</span>
<span id="cb31-7"><a href="5-frequency-of-clonal-expansion.html#cb31-7"></a>p</span></code></pre></div>
<p><img src="index_files/figure-html/plot%20the%20frequencies-1.png" width="672" /></p>
<p>In line with previous findings, we see the increase in the frequency of <code>AP</code> vs
<code>nonAP</code> but no pattern with respect to diagnosis. There is one AP point that
overlaps in its clonal expansion frequency with nonAP and upon checking we find
again, that it is our anomalous sample IJ028 that has the lowest frequency of
all of the samples.</p>
<p>To verify our findings we will do a Mann–Whitney U test.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="5-frequency-of-clonal-expansion.html#cb32-1"></a><span class="co">#Shapiro-Wilk test to assess whether expansion frequencies are normal or not</span></span>
<span id="cb32-2"><a href="5-frequency-of-clonal-expansion.html#cb32-2"></a><span class="kw">shapiro.test</span>(df<span class="op">$</span>expansion_frequency)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  df$expansion_frequency
## W = 0.90129, p-value = 0.007766</code></pre>
<p>The Shapiro-Wilk test justifies the usage of a nonparameteric test as the
Wilcoxon test used here.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="5-frequency-of-clonal-expansion.html#cb34-1"></a><span class="kw">wilcox.test</span>(expansion_frequency <span class="op">~</span><span class="st"> </span>Sample.Type, <span class="dt">data=</span>df)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  expansion_frequency by Sample.Type
## W = 240, p-value = 6.655e-09
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>As we can see the null hypothesis of true location shift is equal to 0 can be
rejected under the significance level <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>As an additional visualization we want to see if there is a pattern in the
clonotype expansion frequency with regard to the haplotype HLA-DR15,
but we again do not see a pattern.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="5-frequency-of-clonal-expansion.html#cb36-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb36-2"><a href="5-frequency-of-clonal-expansion.html#cb36-2"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">subset</span>(HLADR15 <span class="op">!=</span><span class="st"> &quot;?&quot;</span>), </span>
<span id="cb36-3"><a href="5-frequency-of-clonal-expansion.html#cb36-3"></a>            <span class="kw">aes</span>(<span class="dt">x =</span> Sample.Type, <span class="dt">y =</span> expansion_frequency,</span>
<span id="cb36-4"><a href="5-frequency-of-clonal-expansion.html#cb36-4"></a>                                               <span class="dt">color =</span> Diagnosis)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-5"><a href="5-frequency-of-clonal-expansion.html#cb36-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb36-6"><a href="5-frequency-of-clonal-expansion.html#cb36-6"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Sample Type&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;clonal expansion frequency&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb36-7"><a href="5-frequency-of-clonal-expansion.html#cb36-7"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb36-8"><a href="5-frequency-of-clonal-expansion.html#cb36-8"></a><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span>HLADR15, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span></span>
<span id="cb36-9"><a href="5-frequency-of-clonal-expansion.html#cb36-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</span>
<span id="cb36-10"><a href="5-frequency-of-clonal-expansion.html#cb36-10"></a>p</span></code></pre></div>
<p><img src="index_files/figure-html/plot%20frequency%20for%20HLADR15-1.png" width="672" /></p>
</div>
<p style="text-align: center;">
<a href="4-bracer.html"><button class="btn btn-default">Previous</button></a>
<a href="6-isotype-analysis.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
